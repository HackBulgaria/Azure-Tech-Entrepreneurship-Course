JavaScript базиран CAD софтуер

Вече няколко пъти съм писал за предимствата на JavaScript. Даже бяхме влезли във виртуален спор с колега дали JavaScript е език само за "клиента/фронт-енд-а" - да си свършиш малко работа от рода на 'падащо меню'. Или може да бъде реален език за създаване на сериозен софтуер?

Надявам се да ви убедя, че JavaScript навсякъде е добър избор за технологичен стек за:

създаване на сериозен SaaS софтуер;
стартиращи компании, които искат бързо да създадат Minimum Vaible Product (MVP).
Под много сериозен, визирам сериозен софтуер, с много възможности.  Officernd е такъв софтуер. Все още далеч не сме имплементирали всичко, което искаме, но ако се замислите се опитваме да създадем опростен CAD (Computer Aided Design) софтуер в браузъра + още повече функционалност на сървъра.

Officernd Designer

От любов към JavaScript избрахме да ползваме MEAN (MongoDB, ExpressJS, AngularJS, NodeJS )- JavaScript навсякъде.

Базата - MongoDB

Всеки софтуер започва с Данните. Трудно може да минем без база данни от някакъв вид. В днешно време има хиляди начина да си пазим данните и един от тях е NoSQL решение, като MongoDB. Предимствата на подобна, документно ориентирана база са не малко:

Скалира хоризонтално, което води до много по-добра производителност - по-лесно  и по-евтино;
Работиш с обекти (документи), което улеснява разработката - а тези обекти са, разбира се, JavaScript Object Notation обекти - JSON;
Динамична структура - пазиш документи, които мога да имат, а могат и да нямат структура;
Лесно конфигуриране, инсталиране или директно използване на Cloud базирана база данни.
Скоро ще имаме специален пост по темата, но ако ви е любопитно - тук има добро сравнение с релационните бази данни.

Ние в Officernd използваме Cloud базирано Mongo-as-a-Service решение, което е безплатно за стартиращи компании. Няма нужда да инсталираш каквото и да било и се сетъпва за минути. Стартираш безплатно, а когато потрябват повече данни или производителност, има подходящи планове за всеки.

Сървърът - NodeJS

За да стигнат данните от клиента до базата и обратно, най-често ти трябва междинен слой - Сървър. Той взима данни от базата, обработва ги евентуално, пакетира ги и да ги праща на клиента. В нашия случай имаме доста интересни логики на сървъра, които правят анализ на пространство и правила за по-добро офис планиране. Указва се, че само с JavaScript може много лесно да се постигне това с NodeJS. За разлика от PHP, Java, .NET и други сървърни технологии, NodeJS има много сериозни предимства:

Асинхронен модел на обработка, базиран на събития (event-driven), подобно на Ruby и Python, което това води до:
Невероятна производителност;
Възможност за лесно скалиране, при по-сериозно натоварване;
Пишеш JavaScript - дори и да не ти харесва езикът, самият факт, че използваш същия език на сървъра и на клиента е голям плюс. Голяма част от логиката, която има на сървъра, може да бъде преизползвана на клиента с помощта на общи модули;
Лесен и интуитивен програмен модел. Голяма част от 'старите' сървърни платформи са доста натоварени от абстракции над абстракциите, което много често освен, че натоварва производителността, натоварва и програмистите. В един момент не можеш да разбереш какво става, а нещата не са толкова сложни. :)
Възползваш се от хиляди вече написани модули (npm), които е въпрос на един ред да бъдат интегрирани и използвани - например цялата authentication система с Facebook, Google и други OAuth провайдъри я взимаш на готово. Всички те са с отворен код, което ти дава голяма свобода и спокойствие.
Един от тези модули е Epxress - доста лесен и приятен http сървър, който ти дава много комуникационни решения на готово - лесно рутиране, създаване на APIs и т.н.
Ще си говорим повече за NodeJS в специална тема.

Функционалност на клиента - AngularJS

Дори и много да харесваш JavaScript, истината е, че езикът си има много проблеми и в много отношения е ужасен. Особено, когато са намесени различни браузъри. Нямаш много опит. Или просто си свикнал със статични, компилиращи се езици. Поради тази причина трудно мога да си представя да създаваш JavaScript базиран софтуер, без подходяща основа - платформа, който да скрие някои от неприятните моменти на браузърите и езика. Един такъв пример е jQuery, разбира се. Но jQuery не ти дава платформа за създаване на приложения. Не ти дава структура и добри практики, както и някои важни абстракции за по-добър application код.

Тук идва AngularJS - това е Application Framework, който цели да улесни създаването на Богати Интернет Приложения, а не просто да ти помогне да си селектираш един елемент и да му смениш цвета. Ето някой от плюсовете на Angular:

Абстракции за добро структуриране на кода - вариант на MVC шаблона;
Преизползваемост на компоненти - JavaScript услуги и HTML - темплейти;
Лесно разширяване (extensibility) на функционалност;
Модуларност - базирана на Dependency injection;
Тестваемост;
И куп други предимства.
Външен вид на клиента - Bootstrap

Едва ли в 21 век има някой, който започва front-end-а на уеб проект от нулата, но ако има, моля ви, недейте. :) Ако искате да стартирате бързо и да постигнете приличен резултат, когато става дума за външен вид - изберете си Front-end framework, като например Bootstrap. Предимствата са много, отново:

Леснота на работа - дори програмист може да се оправи със сложната работа на Front-end-а; В Officernd аз съм Front-end (то си личи де :) ).
Безброй много готова функционалност, която почти всеки сайт има нужда;
Справя се с всички браузъри;
Справя се страхотно на мобилни устройства - responsive;
В интернет има много примери и готови шаблони и темплейти, решения и т.н.
Това са само малка част от технологиите, които използваме в Officernd, за разработката на самия продукт. В конкретните статии напред ще влизаме в детайлите на самите технологии и съпътстващите ги допълнения, разширения и интеграции.

Respnsivness
Officernd Responsiveness, thanks to Bootstrap
Най-важно е времето!

Не забравяйте, че в стартъп света времето е най-важното нещо - колкото по-бързо успеем да създадем MVP (Minimum Viable Product) на идеята си, толкова по-добре (След като първо сме я валидирали!). Изборът на технологии е ключов, когато стартираме. MEAN -JavaScript навсякъде - е много добър вариант за стартиращи компании. Но имайте предвид също, че понякога, най-добрият избор е просто да стартираме с технологиите, които познаваме най-добре. :)

Защо nodejs

След като сме валидирали стартъп идеята си и сме сигурни, че е крайно време да започнем да пишем код, може да се захванем с поставянето на основите на проекта. Помислите внимателно преди да започнете, за да сте сигурни, че основите, които ще поставите, всъщност ще ви свършат работа в краткосрочен (MVP) и дългосрочен (продукт) план. За Officernd избрахме nodejs и сме щастливи с избора си поради основно 5 причини:

Леснота за разработване;
Производителност и скалируемост;
Независимост от ОС и среди за разработка;
Преизползваемост на готови модули;
Лесно и безплатно деплойване.
Помислете също в дългосрочен план - ако се наложи да наемете хора - може ли да си намерите подходящи програмисти? Колко лесно ще ви е? Има ли голяма разлика в търсенето и предлагането на кадри? Какви са тенденциите в България и по света?

Да приемем, че от морето от технологии сте избрали nodejs.

Леснота за разработка и/или Производителност

За мен nodejs предоставя и двете - лесна среда за разработка (основно защото е JavaScript) и супер добра производителност (основно, защото е асинхронен, event-базиран модел на изпълнение) и скалируемост. Не мога да кажа, че nodejs е най-лесната платформа за разработка. Даже кода изглежда доста грозноват понякога (The Christmas tree). Но определено смятам, че е много лесна за разбиране и за създаване на определен тип приложения - API-базирани web/SPA приложения. А това е много важно за един cloud стартъп. Ако от самото начало започнем с добро API, имаме много по-добра основа за развиване на истински SaaS продукт.

nodejs-workshop-javascript-async-21-638

Интересното обаче е, че неотдавна, противопоставянето на тези 'Леснотата за разработка' и 'Производителност' раздели nodejs общността. Както знаете nodejs е open source платформа, чиято разработка се спонсорира от компанията Joyent, за която производителността е на първо място. Докато голяма част от обществото, което го разработва (и е в основата на създаването на nodejs) предпочита да се фокусира повече върху леснотата и чистотата на разработването на софтуер (Joyent - performance over usability and robustness). Поради тази причина, хората, които са повече ЗА леснота за разработка, направиха нова версия на nodejs (fork), която се казва io.js.

За всеки програмист е ясно, че и двете парадигми са важни. Но коя е по-важна и трябва ли всъщност да избираме между двете, не е ясно. Времето ще покаже. :)

Среда за разработка

Всеки програмист до известна степен е свикнал с една или друга среда и не всеки обича да я сменя. Помислете внимателно за вашия екип - кой на каква операционна система е, има ли любима среда? Има ли език за програмиране, в който е супер опитен? Например в Officernd сме 1 Windows, 2 Mac-a и 1 Linux. Което означава, че на нас задължително ни трябва език и среда, които са не просто независими от ОС, а са лесни за работа навсякъде.

NodeJS няма сериозни проблеми и може да се работи 'почти' еднакво добре и на 3-те. Ползваме основно 2 среди:

WebStorm - пълно IDE, което предоставя всичко необходимо за разработка, дори и много не-необходими неща, които понякога бавят работата. Поне предоставя няколко милиона опции да си ги спрете и конфигурирате. :)
Sublime + Node Inspector - за тези от вас, които предпочитат простотата на редактор, Sublime е добро и бързо решение. Безплатно. Единствено е необходимо да настроите Node, да заработи с Blink Debug tools, за да имате дебъгер.
Да започваме

Има няколко начина да започнете проекта си:

Yeoman Generator - това е конзолно приложение, което може да изгенерира огромна част от кода, който ви е нужен за начало. Например за MEAN стек, има един много подходящ генератор  - Angular Full-stack. С Yeoman горе-долу за 2 минути, може да имате up-and-running Node-Express-Angular приложение, което да включва authentication, deployment packaging, minification, task runner и куп други функционалности, които рано или късно ще ви трябват.
Mean.io - това е платформа, която би трябвало също да ни в сетъпва проект, но никога не съм я пробвал. Ако някой има мнение и желание, нека сподели опит.
От нулата - Officernd го започнахме от нулата (защото преди 3 месеца не знаех за съществуването на Yeoman). Това е малко по-сериозна задача, но си има своите плюсове. Може да изградите основите си постепенно и да добавяте нещата, които ви трябват, когато ви потрябват. При Yeoman, малко получаваш всичко на готово и то е толкова много, че може по-скоро да се откажеш. :)
Това, което мога да ви препоръчам е да започнете от нулата (tutorial), но да гледате много внимателно какво прави Yeoman (или Mean.io) и да взаимствате максимално концепциите от него.

nodejs

Модули и npm

Надявам се вече сте успели да пуснете nodejs приложение. Една от най-големите сили на nodejs е Node Package Manager (npm) и огромното общество около тях. Както се досещате, това е платформа за дистрибуция на модули, готови за преизползване и лесни за интегриране. Ето кои ползваме в Officernd и за какво:

Web Server - express и прилежащите му модули;
Разпределена сесия в Redis store - express-session + connect-redis;
Web Templates - swig;
Authentication - passport - за локална, faceboook и google аутентикация;
Object Data Modeling - mongoose;
Паралелна обработка - async;
Функционален стил за обработване на данни - lodash;
API - swagger-node-express;
Изпращане на мейли - nodemailer;
Task Runner - grunt - за задачи свързани с build и deploy;
Това са основните модули, които ви трябват за стабилна основа на вашето web/cloud приложение. Всеки от тях решава конкретни, сериозни проблеми и ще ви спести много работа. Преди да се впуснете в писането на на нова функционалност, проверете дали вече няма модул за това. Шанса да има е доста голям.

За деплойването ще си говорим в други теми. Само ще спомена, че когато имате 'нещо' готово, е въпрос на 1 ред в конзолата (безплатно) да го качите на Heroku, Amazon, Azure или някоя cloud инфраструктура по избор.